<?php

namespace Database\Seeders;

use App\Models\ScopeOneEmissionData;
use Carbon\Carbon;
use Illuminate\Database\Console\Seeds\WithoutModelEvents;
use Illuminate\Database\Seeder;

class ScopeOneEmissionDataTableSeeder extends Seeder
{
    /**
     * Run the database seeds.
     */
    public function run(): void
    {
        $scope_one_emission_inventory = [
            [
                "id" => 11,
                "from_date" => "2023-06-28",
                "to_date" => "2023-12-31",
                "units" => 40000.00,
                "unit_of_measurements" => "mmBtu",
                "location" => "7",
                "organization_id" => 3,
                "user_id" => 5,
                "other_fields" => "{\"date\": [\"2023-06-28T07:24:00.000Z\", \"2023-12-31T07:24:00.000Z\"], \"isUpdate\": 1}",
                "created_at" => "2024-06-27 06:24:59",
                "updated_at" => "2024-06-27 06:38:10",
                "category_id" => 1,
                "total_ghg" => 2124.5804000000,
            ],
            [
                "id" => 12,
                "from_date" => "2024-01-01",
                "to_date" => "2024-06-27",
                "units" => 25000.00,
                "unit_of_measurements" => "mmBtu",
                "location" => "5",
                "organization_id" => 3,
                "user_id" => 5,
                "other_fields" => "{\"date\": [\"2024-01-01T07:25:00.000Z\", \"2024-06-27T07:25:00.000Z\"], \"isUpdate\": 1}",
                "created_at" => "2024-06-27 06:26:10",
                "updated_at" => "2024-06-27 06:36:46",
                "category_id" => 1,
                "total_ghg" => 1327.8627500000,
            ],
            [
                "id" => 13,
                "from_date" => "2023-05-01",
                "to_date" => "2023-06-27",
                "units" => 10000.00,
                "unit_of_measurements" => "mmBtu",
                "location" => "7",
                "organization_id" => 3,
                "user_id" => 5,
                "other_fields" => "{\"date\": [\"2023-05-01T07:38:00.000Z\", \"2023-06-27T07:38:00.000Z\"]}",
                "created_at" => "2024-06-27 06:39:28",
                "updated_at" => "2024-06-27 06:39:28",
                "category_id" => 1,
                "total_ghg" => 531.1451000000,
            ],
            [
                "id" => 15,
                "from_date" => "2023-07-31",
                "to_date" => "2024-06-01",
                "units" => 337.00,
                "unit_of_measurements" => "GJ",
                "location" => "11",
                "organization_id" => 1,
                "user_id" => 2,
                "other_fields" => "{\"date\": [\"2023-07-31T03:29:00.000Z\", \"2024-06-01T03:29:00.000Z\"]}",
                "created_at" => "2024-07-04 02:30:18",
                "updated_at" => "2024-07-04 02:30:18",
                "category_id" => 1,
                "total_ghg" => 16.9655377198,
            ],
            [
                "id" => 16,
                "from_date" => "2023-07-01",
                "to_date" => "2024-06-30",
                "units" => 139.00,
                "unit_of_measurements" => "GJ",
                "location" => "21",
                "organization_id" => 1,
                "user_id" => 2,
                "other_fields" => "{\"date\": [\"2023-07-01T04:24:00.000Z\", \"2024-06-30T04:24:00.000Z\"]}",
                "created_at" => "2024-07-04 03:25:45",
                "updated_at" => "2024-07-04 03:25:45",
                "category_id" => 1,
                "total_ghg" => 6.9976550239,
            ],
            [
                "id" => 17,
                "from_date" => "2023-07-01",
                "to_date" => "2024-06-30",
                "units" => 2028.00,
                "unit_of_measurements" => "GJ",
                "location" => "14",
                "organization_id" => 1,
                "user_id" => 2,
                "other_fields" => "{\"date\": [\"2023-07-01T04:27:00.000Z\", \"2024-06-30T04:27:00.000Z\"]}",
                "created_at" => "2024-07-04 03:28:00",
                "updated_at" => "2024-07-04 03:28:00",
                "category_id" => 1,
                "total_ghg" => 102.0952833700,
            ],
            [
                "id" => 18,
                "from_date" => "2023-07-01",
                "to_date" => "2024-06-30",
                "units" => 1035.00,
                "unit_of_measurements" => "GJ",
                "location" => "13",
                "organization_id" => 1,
                "user_id" => 2,
                "other_fields" => "{\"date\": [\"2023-07-01T04:28:00.000Z\", \"2024-06-30T04:28:00.000Z\"]}",
                "created_at" => "2024-07-04 03:28:59",
                "updated_at" => "2024-07-04 03:28:59",
                "category_id" => 1,
                "total_ghg" => 52.1048413649,
            ],
            [
                "id" => 23,
                "from_date" => "2024-04-02",
                "to_date" => "2024-05-01",
                "units" => 10000.00,
                "unit_of_measurements" => "km",
                "location" => "13",
                "organization_id" => 1,
                "user_id" => 2,
                "other_fields" => "{\"date\": [\"2024-04-02T06:27:00.000Z\", \"2024-05-01T06:27:00.000Z\"]}",
                "created_at" => "2024-07-18 05:27:51",
                "updated_at" => "2024-07-18 05:27:51",
                "category_id" => 6,
                "total_ghg" => 1.7200797337,
            ],
            [
                "id" => 24,
                "from_date" => "2024-07-02",
                "to_date" => "2024-07-17",
                "units" => 10000.00,
                "unit_of_measurements" => "km",
                "location" => "13",
                "organization_id" => 1,
                "user_id" => 2,
                "other_fields" => "{\"date\": [\"2024-07-02T06:27:00.000Z\", \"2024-07-17T06:27:00.000Z\"]}",
                "created_at" => "2024-07-18 05:28:07",
                "updated_at" => "2024-07-18 05:28:07",
                "category_id" => 7,
                "total_ghg" => 1.8025356909,
            ],
            [
                "id" => 25,
                "from_date" => "2024-07-02",
                "to_date" => "2024-07-17",
                "units" => 10000.00,
                "unit_of_measurements" => "km",
                "location" => "22",
                "organization_id" => 1,
                "user_id" => 2,
                "other_fields" => "{\"date\": [\"2024-07-02T06:28:00.000Z\", \"2024-07-17T06:28:00.000Z\"]}",
                "created_at" => "2024-07-18 05:28:23",
                "updated_at" => "2024-07-18 05:28:23",
                "category_id" => 8,
                "total_ghg" => 1.1375442412,
            ],
            [
                "id" => 26,
                "from_date" => "2022-06-01",
                "to_date" => "2022-06-30",
                "units" => 1100.00,
                "unit_of_measurements" => "GJ",
                "location" => "13",
                "organization_id" => 1,
                "user_id" => 2,
                "other_fields" => "{\"date\": [\"2022-06-01T16:57:00.000Z\", \"2022-06-30T16:57:00.000Z\"]}",
                "created_at" => "2024-07-26 15:58:52",
                "updated_at" => "2024-07-26 15:58:52",
                "category_id" => 1,
                "total_ghg" => 55.3771260883,
            ],
            [
                "id" => 27,
                "from_date" => "2024-05-01",
                "to_date" => "2024-05-31",
                "units" => 2200.00,
                "unit_of_measurements" => "GJ",
                "location" => "14",
                "organization_id" => 1,
                "user_id" => 2,
                "other_fields" => "{\"date\": [\"2024-05-01T16:59:00.000Z\", \"2024-05-31T16:59:00.000Z\"], \"isUpdate\": 1}",
                "created_at" => "2024-07-26 15:59:32",
                "updated_at" => "2024-07-26 17:47:12",
                "category_id" => 1,
                "total_ghg" => 110.7542521765,
            ],
            [
                "id" => 28,
                "from_date" => "2024-05-01",
                "to_date" => "2024-05-31",
                "units" => 330.00,
                "unit_of_measurements" => "GJ",
                "location" => "11",
                "organization_id" => 1,
                "user_id" => 2,
                "other_fields" => "{\"date\": [\"2024-05-01T16:59:00.000Z\", \"2024-05-31T16:59:00.000Z\"], \"isUpdate\": 1}",
                "created_at" => "2024-07-26 16:00:28",
                "updated_at" => "2024-07-26 17:47:26",
                "category_id" => 1,
                "total_ghg" => 16.6131378265,
            ],
            [
                "id" => 29,
                "from_date" => "2024-05-01",
                "to_date" => "2024-05-31",
                "units" => 150.00,
                "unit_of_measurements" => "GJ",
                "location" => "21",
                "organization_id" => 1,
                "user_id" => 2,
                "other_fields" => "{\"date\": [\"2024-05-01T17:01:00.000Z\", \"2024-05-31T17:01:00.000Z\"], \"isUpdate\": 1}",
                "created_at" => "2024-07-26 16:01:48",
                "updated_at" => "2024-07-26 17:47:38",
                "category_id" => 1,
                "total_ghg" => 7.5514262848,
            ],
            [
                "id" => 30,
                "from_date" => "2024-03-01",
                "to_date" => "2024-03-31",
                "units" => 2500.00,
                "unit_of_measurements" => "GJ",
                "location" => "12",
                "organization_id" => 1,
                "user_id" => 2,
                "other_fields" => "{\"date\": [\"2024-03-01T19:47:00.000Z\", \"2024-03-31T18:47:00.000Z\"]}",
                "created_at" => "2024-07-26 17:48:13",
                "updated_at" => "2024-07-26 17:48:13",
                "category_id" => 1,
                "total_ghg" => 125.8571047460,
            ],
            [
                "id" => 32,
                "from_date" => "2024-01-26",
                "to_date" => "2024-08-26",
                "units" => 4554545.00,
                "unit_of_measurements" => "mmBtu",
                "location" => "13",
                "organization_id" => 1,
                "user_id" => 2,
                "other_fields" => NULL,
                "created_at" => "2024-08-26 15:19:54",
                "updated_at" => "2024-08-26 15:19:54",
                "category_id" => 1,
                "total_ghg" => 241390.8850000000,
            ],
        ];
        //truncate all Scope One Data
        ScopeOneEmissionData::truncate();
        foreach ($scope_one_emission_inventory as $data) {
            // Calculate the number of months between from_date and to_date
            $from_date = Carbon::parse($data['from_date']);
            $to_date = Carbon::parse($data['to_date']);
            $months = $from_date->diffInMonths($to_date) + 1; // +1 to include the start month

            // Calculate emissions per month
            $emissions_per_month = $months > 0 ? $data['total_ghg'] / $months : $data['total_ghg'];

            // Insert data into ScopeOneEmissionData model
            ScopeOneEmissionData::create([
                'id'=>$data['id'],
                'organization_id'=> $data['organization_id'],
                'organization_branch_id' => $data['location'],
                'category_id' => $data['category_id'],
                'user_id' => $data['user_id'],
                'from_date' => $data['from_date'],
                'to_date' => $data['to_date'],
                'units' => $data['units'],
                'unit_of_measurement' => $data['unit_of_measurements'],
                'emissions_per_month' => $emissions_per_month,
                'total_ghg' => $data['total_ghg'],
                "created_at" => $data['created_at'],
                "updated_at" => $data['updated_at'],
            ]);
        }

    }
}
